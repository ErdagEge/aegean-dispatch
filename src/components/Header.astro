---
const { pathname } = Astro.url;
const base = (import.meta.env.BASE_URL ?? '/').replace(/\/?$/, '/');
const withBase = (href: string) =>
  href.startsWith('/') ? `${base}${href.replace(/^\//, '')}` : href;

const navLinks = [
  { href: withBase('/'), label: 'Home' },
  { href: withBase('/about'), label: 'About' },
  { href: withBase('/posts'), label: 'All Posts' }
];

const isActive = (href: string) => {
  const target = href.replace(/\/$/, '');
  const current = pathname.replace(/\/$/, '');
  return current === target || current.startsWith(target);
};
---

<header>
  <nav class="nav">
    <a class="nav-brand" href={withBase('/')}>Aegean Dispatch</a>
    <div class="nav-links">
      {navLinks.map((link) => (
        <a
          class={`${isActive(link.href) ? 'nav-link is-active' : 'nav-link'}`}
          href={link.href}
        >
          {link.label}
        </a>
      ))}
    </div>
  </nav>
</header>
